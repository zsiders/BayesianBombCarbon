<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with BayesianBombCarbon • BayesianBombCarbon</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with BayesianBombCarbon">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianBombCarbon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/basic-workflow.html">Getting started with BayesianBombCarbon</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zsiders/BayesianBombCarbon/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with BayesianBombCarbon</h1>
            
      

      <div class="d-none name"><code>basic-workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Running BayesianBombCarbon on a given dataset involves several steps.
The key step is preparing the data with teh <code>data_prep</code>
function. This function takes both a reference series dataset and/or a
sample dataset with unknown true formation/birth years. If the reference
series is supplied only, the reference series is fit with a Bayesian
penalized B-spline. If a sample dataset is also supplied, then a
reference series is fit while also estimating the aging bias of the
sample dataset. Users can also pre-determine the formation/birth years
the model will predict the reference series over in the
<code>data_prep</code> function. The function <code><a href="../reference/est_model.html">est_model()</a></code>
will take the prepared dataset and using <code>cmdstanr</code> fit the
designated model while <code>extract_draws</code> will pull the relevant
posterior parameter samples from the fitted model. Lastly, users can use
<code>plot_fit</code> to visualize the predicted reference series,
posterior parameter distributions, and, if sample data is supplied, the
observed and bias-adjusted samples.</p>
<p>First, we must load the R library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https:">BayesianBombCarbon</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reference-series">Reference series<a class="anchor" aria-label="anchor" href="#reference-series"></a>
</h2>
<div class="section level3">
<h3 id="using-the-provided-simulated-dataset">Using the provided simulated dataset<a class="anchor" aria-label="anchor" href="#using-the-provided-simulated-dataset"></a>
</h3>
<p>The provided dataset is a <code>data.frame</code> that was simulated
from a hypothetical reference series with a damped oscillating linear
decay function after the peak of ∆14C. Three columns are provided but
only <code>BY</code> and <code>C14</code> are used by the
<code>data_prep</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can visualize the reference series data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sim_ref</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">BY</span>,<span class="va">C14</span>, pch<span class="op">=</span><span class="fl">16</span>, xlab<span class="op">=</span><span class="st">"Reference/Birth Year"</span>,</span>
<span>       ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Delta</span><span class="op">^</span><span class="fl">14</span><span class="op">*</span><span class="va">C</span><span class="op">~</span><span class="st">"(\u2030)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="img/sim_ref_viz.png" alt="plot of chunk sim_ref_viz"><p class="caption">
plot of chunk sim_ref_viz
</p>
</div>
</div>
<div class="section level3">
<h3 id="preparing-a-reference-series-only-dataset-for-estimation">Preparing a reference series only dataset for estimation<a class="anchor" aria-label="anchor" href="#preparing-a-reference-series-only-dataset-for-estimation"></a>
</h3>
<p>To prepare a dataset for estimation, we need to provide at least one
<code>data.frame</code> with named columns of <code>BY</code> and
<code>C14</code> that provide the reference series data to the function
<code>data_prep</code>. Internally, <code>data_prep</code> assesses what
dataset(s) you’ve provided and generates a named list object with a two
components, 1. a character vector in the <code>flag</code> component
that tells other functions what model was setup and 2. a named list with
the data parsed and matched the <code>stan</code> model format.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>df_ref <span class="op">=</span> <span class="va">sim_ref</span><span class="op">)</span></span>
<span><span class="co">#&gt; No values provided in df_unk, skipping validation and estimating reference series only</span></span></code></pre></div>
<p>We can also provide further specifications of the knots used in the
penalized B-spline with name list with values: + <code>knot.min</code> -
sets the minimum number of knots, default of 10. + <code>knot.adj</code>
- divisor in number of knots = number of reference series data
points/knot.adj, default is 4. + <code>fixed.knot</code> - integer
number of fixed number of knots that overrides <code>knot.adj</code>
calculation + <code>spline.degree</code> - polynomial degree, default is
3. + <code>pad.spline</code> - fraction of the range of formation/birth
years in the reference series that is padded to the beginning and end of
the knot locations, default is 1%.</p>
<p>We can also change the locations of the predicted reference series
through the argument <code>pred.by</code>. Prediction is accomplished
within the model in the <code>generated quantities</code> section in the
<code>stan</code> model. We can either provide a vector of
formation/birth years desired to <code>pred.by</code> or we can provided
a named list to <code>pred.by</code> to set up a sequence call: +
<code>min.by</code> - minimum year of the formation/birth year
prediction sequence + <code>max.by</code> - maximum year of the
formation/birth year prediction sequence + <code>inc.by</code> -
formation/birth year increment of the prediction sequence</p>
</div>
<div class="section level3">
<h3 id="estimating-a-reference-series-only">Estimating a reference series only<a class="anchor" aria-label="anchor" href="#estimating-a-reference-series-only"></a>
</h3>
<p>Now that we have covered the data preparation, let’s estimate the
reference series. This function will also estimate other models by
checking the <code>flag</code> component of the data list setup by the
<code>data_prep</code> function. Additional arguments can be provided to
<code>est_model</code> that control the behavior of the
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">cmdstanr::sample</a></code> call. Run <code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">?cmdstanr::sample</a></code>
to view the possible arguments. For most reference series, the default
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">cmdstanr::sample</a></code> arguments work fine. You may wish to set
<code>parallel_chains</code> argument equal to the default number of
<code>chains=4</code> to achieve parallel processing. Though, estimating
reference-series only models is generally extremely fast (&lt; 10 secs
on the author’s machine).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_model.html">est_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, show_messages <span class="op">=</span> <span class="cn">FALSE</span>, show_exceptions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>est_model</code> function returns a named list with
<code>model</code> containing the <code>stan</code> model code that was
sampled from and <code>fitted</code> which contains the output from
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">cmdstanr::sample</a></code>. Functions that work on
<code>CmdStanMCMC</code> objects produced from
<code><a href="https://mc-stan.org/cmdstanr/reference/model-method-sample.html" class="external-link">cmdstanr::sample</a></code> also work on this <code>fit$fitted</code>
object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">fitted</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'C14_pred'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 81 × 10</span></span>
<span><span class="co">#&gt;    variable     mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 C14_pred[1] -52.4  -52.6  5.18  5.17 -61.0 -44.1 1.00     4162.    4055.</span></span>
<span><span class="co">#&gt;  2 C14_pred[2] -52.0  -52.1  4.95  5.04 -60.2 -43.9 1.00     4041.    3736.</span></span>
<span><span class="co">#&gt;  3 C14_pred[3] -51.1  -51.0  4.92  4.80 -59.2 -43.0 1.00     3990.    3694.</span></span>
<span><span class="co">#&gt;  4 C14_pred[4] -50.2  -50.1  4.92  4.91 -58.2 -41.9 0.999    3778.    3718.</span></span>
<span><span class="co">#&gt;  5 C14_pred[5] -50.1  -50.1  4.94  4.92 -58.0 -41.7 1.00     3873.    3685.</span></span>
<span><span class="co">#&gt;  6 C14_pred[6] -50.8  -50.8  4.99  4.95 -59.1 -42.5 1.00     4062.    3688.</span></span>
<span><span class="co">#&gt;  7 C14_pred[7] -51.1  -51.1  5.10  4.99 -59.6 -42.9 1.00     4076.    3794.</span></span>
<span><span class="co">#&gt;  8 C14_pred[8] -49.5  -49.5  4.94  4.89 -57.7 -41.4 1.00     3745.    3586.</span></span>
<span><span class="co">#&gt;  9 C14_pred[9] -47.8  -47.8  5.03  5.13 -56.0 -39.6 1.00     3866.    3833.</span></span>
<span><span class="co">#&gt; 10 C14_pred[1… -46.9  -46.9  5.08  5.08 -55.4 -38.5 1.00     4187.    3873.</span></span>
<span><span class="co">#&gt; # ℹ 71 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extracting-posterior-draws">Extracting posterior draws<a class="anchor" aria-label="anchor" href="#extracting-posterior-draws"></a>
</h3>
<p>Posterior draws of parameters can be accomplished by calling
<code><a href="https://mc-stan.org/cmdstanr/reference/fit-method-draws.html" class="external-link">cmdstanr::draws</a></code> on the <code>fit$fitted</code>
<code>CmdStanMCMC</code> object produced through <code>est_model</code>
or a wrapper function is provided as <code>extract_draws</code> that
grabs the relevant parameters based on the the model type that was
estimated. This wrapper function inherently skips over some of the
nuisance parameters that are estimated pertaining to the knots in the
penalized B-spline.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ext</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_draws.html">extract_draws</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-fit">Plotting fit<a class="anchor" aria-label="anchor" href="#plotting-fit"></a>
</h3>
<p>Lastly, we can visualize our model fit using <code>plot_fit</code>.
This function takes both the data object from <code>data_prep</code> and
the extracted draws from <code>extract_draws</code> to generate the
plot.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fit.html">plot_fit</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">df</span>, ext <span class="op">=</span> <span class="va">ext</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="img/plot_ref_viz.png" alt="plot of chunk plot_ref_viz"><p class="caption">
plot of chunk plot_ref_viz
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="integrated-method---reference-series-unvalidated-samples">Integrated method - reference series + unvalidated samples<a class="anchor" aria-label="anchor" href="#integrated-method---reference-series-unvalidated-samples"></a>
</h2>
<p><code>BayesianBombCarbon</code> also has an integrated method for
jointly estimating the reference series and the aging bias present in a
set of samples with unvalidated formation/birth years. In the penalized
B-spline, this requires adjusting the knot contribution to each
unvalidated sample each time a new aging bias (formation/birth year
adjustment) is trialed. This massively increases the runtime but, in the
author’s biased opinion, is well worth the wait. The setup is very
similar to the reference series only estimation.</p>
<div class="section level3">
<h3 id="integrated-method-data-preparation">Integrated method data preparation<a class="anchor" aria-label="anchor" href="#integrated-method-data-preparation"></a>
</h3>
<p>We can used the provided simulated reference series data in
<code>sim_ref</code> and the accompanying unvalidated simulated samples
in <code>sim_unk</code>. The latter have a fixed aging bias of +1
year.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can visualize the reference series data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sim_ref</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">BY</span>,<span class="va">C14</span>, pch<span class="op">=</span><span class="fl">16</span>, xlab<span class="op">=</span><span class="st">"Reference/Birth Year"</span>,</span>
<span>       ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Delta</span><span class="op">^</span><span class="fl">14</span><span class="op">*</span><span class="va">C</span><span class="op">~</span><span class="st">"(\u2030)"</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">sim_unk</span>,<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">BY</span>,<span class="va">C14</span>,pch<span class="op">=</span><span class="fl">16</span>,col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topleft'</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Reference'</span>,<span class="st">'Test'</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'black'</span>,<span class="st">'red'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="img/sim_unk_viz.png" alt="plot of chunk sim_unk_viz"><p class="caption">
plot of chunk sim_unk_viz
</p>
</div>
<p>We need to supply two <code>data.frames</code> both with named
columns of <code>BY</code> and <code>C14</code>. One is the reference
series, provided to argument <code>df_ref</code>, and another is the
unvalidated samples, provide to arugment <code>df_unk</code> in the
<code>data_prep</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>df_ref <span class="op">=</span> <span class="va">sim_ref</span>, df_unk <span class="op">=</span> <span class="va">sim_unk</span><span class="op">)</span></span></code></pre></div>
<p>An additional argument <code>ll_wt</code> is added to the
<code>$data</code> object from the <code>data_prep</code> call that
up-weights the reference series data relative to the unvalidated
samples. This is to keep the reference series estimation from chasing
the unvalidated samples. This is set at a default of 5 but if your
reference series is very spotty where you have unvalidated samples, you
may wish to increase this value. It has no associated runtime cost.</p>
</div>
<div class="section level3">
<h3 id="estimating-an-integrated-penalized-b-spline">Estimating an integrated penalized B-spline<a class="anchor" aria-label="anchor" href="#estimating-an-integrated-penalized-b-spline"></a>
</h3>
<p>Just as with the reference series estimation, we call
<code>est_model</code> to estimate the integrated model. We do recommend
adjusting the <code>cmdnstanr::sample</code> arguments when running the
integrated model to at least increase the warmup iterations. We also
recommend setting up parallel processing with the
<code>parallel_chains</code> argument as these models have longer
runtimes. You may also receive a warning that some transistions hit the
maximum treedepth of 10. This can be resolved by changing the
<code>max_treedepth</code> argument to &gt; 10.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/est_model.html">est_model</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_int</span>, iter_warmup <span class="op">=</span> <span class="fl">3000</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>, show_messages <span class="op">=</span> <span class="cn">FALSE</span>, show_exceptions <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extracting-posterior-draws-1">Extracting posterior draws<a class="anchor" aria-label="anchor" href="#extracting-posterior-draws-1"></a>
</h3>
<p>Just as before, we can extract posterior draws using the
<code>extract_draws</code> wrapper function. Note, that you should
provide the <code>data_prep</code> object to the <code>df</code>
argument so that an additional posterior will be generated of
<code>BY_adj</code>, which adjusts the unvalidated formation/birth years
by the posterior of the aging bias/adjustment.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ext_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_draws.html">extract_draws</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">fit_int</span>, df <span class="op">=</span> <span class="va">df_int</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a>
</h3>
<p>With the posterior parameter draws of the integrated model, you can
conduct formal hypothesis testing of whether your ages are valid. This
is an explicit advantage of the integrated approach that traditional sum
of square approaches do not have. To do this, we recommend the
<code>bayestestR</code> package.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/" class="external-link">bayestestR</a></span><span class="op">)</span></span>
<span><span class="fu">p_map</span><span class="op">(</span><span class="va">ext_int</span><span class="op">$</span><span class="va">adj</span>, null <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; MAP-based p-value</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter | p (MAP)</span></span>
<span><span class="co">#&gt; -------------------</span></span>
<span><span class="co">#&gt; adj       |  &lt; .001</span></span></code></pre>
<p>This returns the Bayesian equivalent of the <em>p</em>-value, see
<code>?bayestestR::p_map</code> for more details. The argument
<code>null</code> can be changed to also explicitly test other null ages
and ask “is my aging bias significantly than X?”.</p>
</div>
<div class="section level3">
<h3 id="plotting-fit-1">Plotting fit<a class="anchor" aria-label="anchor" href="#plotting-fit-1"></a>
</h3>
<p>Lastly, we can visualize our integrated model using
<code>plot_fit</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_fit.html">plot_fit</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">df_int</span>, ext <span class="op">=</span> <span class="va">ext_int</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="img/plot_unk_viz.png" alt="plot of chunk plot_unk_viz"><p class="caption">
Visualization of reference function fit, adjusted unvalidated samples,
and posterior distributions
</p>
</div>
<p>Note that additional features are plotted. The original unvalidated
formation/birth years are shown in the red circles while the adjusted
formation/birth years, along with their credible interval, are shown in
the red ticks. Additional, the posterior densities of the aging
bias/adjustment is provided. A vertical, dashed red segment will
highlight zero if the posterior overlaps or is adjacent to zero. This
provides a visual equivalent of the hypothesis test conducted
earlier.</p>
</div>
</div>
<div class="section level2">
<h2 id="future-work">Future work<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<p><code>BayesianBombCarbon</code> is under development though the core
functionality will remain mostly unchanged in the future. Additional
models will be provided, such as the coupled function from Kastelle et
al. (2011), that will have the reference series only and integrated
method capabilities. General improvements have also been made to the sum
of squares aging bias estimation approach, first presented in Kastelle
et al. (2008), that will be supported soon. If you have
suggestions/requests/bugs, please reach out to <a href="mailto:zsiders@ufl.edu" class="email">zsiders@ufl.edu</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zachary Siders.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
